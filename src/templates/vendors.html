{% extends 'base.html' %}
{% load staticfiles %}

{% block navigation %}
  {% include 'navigation.html' %}
{% endblock %}

{% block content %}
<!-- MAIN CONTENT
================================================== -->
<div class="main-content">
  
  {% include 'navbar.html' %}

  <!-- CONTENT -->
  <div class="container-fluid mt-5 mb-5">
    <div class="row">
      <div class="col-12">
        
        <!-- Files -->
        <div class="card" data-toggle="lists" data-lists-values='["name"]'>
          <div class="card-header">
            <div class="row align-items-center">
              <div class="col">
                
                <!-- Title -->
                <h4 class="card-header-title">
                  Vendors
                </h4>

              </div>
              <div class="col-auto">
                
                <!-- Dropdown -->
                <div class="dropdown">

                  <!-- Toggle -->
                  <a href="#!" class="small text-muted dropdown-toggle" data-toggle="dropdown">
                    Sort order
                  </a>

                  <!-- Menu -->
                  <div class="dropdown-menu">
                    <a class="dropdown-item sort" data-sort="name" href="#!">
                      Asc
                    </a>
                    <a class="dropdown-item sort" data-sort="name" href="#!">
                      Desc
                    </a>
                  </div>

                </div>

              </div>
              <div class="col-auto">
                    
                <!-- Button -->
                <a href="{% url 'app:vendor-create' %}" class="btn btn-sm btn-primary">
                  Post Vendor
                </a>

              </div>
            </div> <!-- / .row -->
          </div>
          <div class="card-header">
            <div class="row">
              <div class="col-12">
                
                <!-- Form -->
                <form>
                  <div class="input-group input-group-flush input-group-merge">
                    <input type="search" class="form-control form-control-prepended search" placeholder="Search">
                    <div class="input-group-prepend">
                      <div class="input-group-text">
                        <span class="fe fe-search"></span>
                      </div>
                    </div>
                  </div>
                </form>

              </div>
            </div> <!-- / .row -->
          </div>
          <div class="card-body">

            <!-- List -->
            <ul class="list-group list-group-lg list-group-flush list my--4">

              {% if not vendors %}
              <li class="list-group-item px-0">
                <div class="row align-items-center">
                    <div class="col-auto">
                      <p>No vendors available.</p>
                    </div>
                </div>
              </li>
              {% endif %}

              {% for vendor in vendors %}
              <li class="list-group-item px-0">
                
                <div class="row align-items-center">
                  <div class="col-auto">
                    
                    <!-- Avatar -->
                    <a class="navbar-brand" href="{% url 'app:home' %}">
                      <div class="avatar avatar-md">
                        <span class="avatar-title rounded-circle">{{vendor.title|first}}</span>
                      </div>
                    </a>

                  </div>
                  <div class="col ml--2">

                    <!-- Title -->
                    <h4 class="card-title mb-1 name">
                      {{vendor.title}}
                      {% if vendor.link %}
                      <a href="{{vendor.link}}" class="text-primary" target="_blank"><span class="fe fe-external-link mr-4"></span></a>
                      {% endif %}
                    </h4>
                    {% for category in vendor.categories %}
                      <span class="badge badge-soft-secondary">{{category}}</span>
                    {% endfor %}
                    

                    <!-- Text -->
                    <p class="card-text small mb-1">
                      {{vendor.description}}<br>Contact: {{vendor.contact}}, <a href="mailto:{{vendor.contact_email}}">{{vendor.contact_email}}</a>
                    </p>

                    <!-- Time -->
                    <p class="card-text small text-muted">
                      Posted by <a href="{% url 'app:profile' vendor.user.username %}">{{vendor.user.first_name}} {{vendor.user.last_name}}</a> on <time datetime="2018-01-03">Jan 3, 2018</time>
                    </p>
                    
                  </div>
                  {% if vendor.user == user %}
                  <div class="col-auto">
                    
                    <!-- Dropdown -->
                    <div class="dropdown">
                      <a href="#!" class="dropdown-ellipses dropdown-toggle" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <i class="fe fe-more-vertical"></i>
                      </a>
                      <div class="dropdown-menu dropdown-menu-right">
                        <a href="{% url 'app:vendor-update' vendor.id %}" class="dropdown-item">
                          Edit
                        </a>
                        <a href="#!" class="dropdown-item delete-vendor" data-toggle="modal" data-target="#delete5" data-id="{{ vendor.id }}">
                          Delete
                        </a>
                      </div>
                    </div>

                  </div>
                  {% endif %}
                </div> <!-- / .row -->

              </li>

              {% endfor %}
            </ul>

          </div>
        </div>

      </div>
    </div> <!-- / .row -->
  </div>
  
</div> <!-- / .main-content -->
<!-- Modal Delete Job -->
<div class="modal fade" id="delete5" tabindex="-1" role="dialog" aria-labelledby="deleteCommentLabel" aria-hidden="true">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content">
      <div class="modal-body p-4">
          <div class="text-center">
              <i class="fe fe-alert-triangle h1 text-warning"></i>
              <h4 class="mt-2">Delete Vendor</h4>
              <p class="mt-3">Are you sure you want to delete this vendor?</p>
              <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>
              <button type="button" class="btn btn-danger my-2 text-white" id="delete-vendor-submit" data-dismiss="modal">Delete</button>
          </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}