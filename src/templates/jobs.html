{% extends 'base.html' %}
{% load staticfiles %}

{% block navigation %}
  {% include 'navigation.html' %}
{% endblock %}

{% block content %}
<!-- MAIN CONTENT
================================================== -->
<div class="main-content">
  
  {% include 'navbar.html' %}

  <!-- CONTENT -->
  <div class="container-fluid mt-5 mb-5">
    <div class="row">
      <div class="col-12">
        
        <!-- Files -->
        <div class="card" data-toggle="lists" data-lists-values='["name"]'>
          <div class="card-header">
            <div class="row align-items-center">
              <div class="col">
                
                <!-- Title -->
                <h4 class="card-header-title">
                  Job Board
                </h4>

              </div>
              <div class="col-auto">
                
                <!-- Dropdown -->
                <div class="dropdown">

                  <!-- Toggle -->
                  <a href="#!" class="small text-muted dropdown-toggle" data-toggle="dropdown">
                    Sort order
                  </a>

                  <!-- Menu -->
                  <div class="dropdown-menu">
                    <a class="dropdown-item sort" data-sort="name" href="#!">
                      Asc
                    </a>
                    <a class="dropdown-item sort" data-sort="name" href="#!">
                      Desc
                    </a>
                  </div>

                </div>

              </div>
              <div class="col-auto">
                    
                <!-- Button -->
                <a href="{% url 'app:job-create' %}" class="btn btn-sm btn-primary">
                  Post Job
                </a>

              </div>
            </div> <!-- / .row -->
          </div>
          <div class="card-header">
            <div class="row">
              <div class="col-12">
                
                <!-- Form -->
                <form>
                  <div class="input-group input-group-flush input-group-merge">
                    <input type="search" class="form-control form-control-prepended search" placeholder="Search">
                    <div class="input-group-prepend">
                      <div class="input-group-text">
                        <span class="fe fe-search"></span>
                      </div>
                    </div>
                  </div>
                </form>

              </div>
            </div> <!-- / .row -->
          </div>
          <div class="card-body">

            <!-- List -->
            <ul class="list-group list-group-lg list-group-flush list my--4">

              {% if not jobs %}
              <li class="list-group-item px-0">
                <div class="row align-items-center">
                    <div class="col-auto">
                      <p>No jobs available.</p>
                    </div>
                </div>
              </li>
              {% endif %}

              {% for job in jobs %}
              <li class="list-group-item px-0">
                
                <div class="row align-items-center">
                  <div class="col-auto">
                    
                    <!-- Avatar -->
                    <span class="avatar avatar-md">
                      {% if job.image %}
                      <img src="{{job.image.url}}" alt="..." class="avatar-img rounded-circle">
                      {% else %}
                      <img src="{% static 'assets/img/logo.png' %}" alt="..." class="avatar-img rounded-circle">
                      {% endif %}
                    </span>

                  </div>
                  <div class="col ml--2">

                    <!-- Title -->
                    <h4 class="card-title mb-1 name">
                      {{job.title}} at {{job.company}} <a href="{{job.link}}" class="text-primary" target="_blank"><span class="fe fe-external-link mr-4"></span></a>
                    </h4>

                    <!-- Text -->
                    <p class="card-text small mb-1">
                      {{job.excerpt}}
                    </p>

                    <!-- Time -->
                    <p class="card-text small text-muted">
                      Posted by <a href="{% url 'app:profile' job.user.username %}">{{job.user.first_name}} {{job.user.last_name}}</a> on <time datetime="2018-01-03">Jan 3, 2018</time>
                    </p>
                    
                  </div>
                  {% if job.user == user %}
                  <div class="col-auto">
                    
                    <!-- Dropdown -->
                    <div class="dropdown">
                      <a href="#!" class="dropdown-ellipses dropdown-toggle" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <i class="fe fe-more-vertical"></i>
                      </a>
                      <div class="dropdown-menu dropdown-menu-right">
                        <a href="{% url 'app:job-update' job.id %}" class="dropdown-item">
                          Edit
                        </a>
                        <a href="#!" class="dropdown-item delete-job" data-toggle="modal" data-target="#delete3" data-id="{{ job.id }}">
                          Delete
                        </a>
                      </div>
                    </div>

                  </div>
                  {% endif %}
                </div> <!-- / .row -->

              </li>

              {% endfor %}
            </ul>

          </div>
        </div>

      </div>
    </div> <!-- / .row -->
  </div>
  
</div> <!-- / .main-content -->
<!-- Modal Delete Job -->
<div class="modal fade" id="delete3" tabindex="-1" role="dialog" aria-labelledby="deleteCommentLabel" aria-hidden="true">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content">
      <div class="modal-body p-4">
          <div class="text-center">
              <i class="fe fe-alert-triangle h1 text-warning"></i>
              <h4 class="mt-2">Delete Job</h4>
              <p class="mt-3">Are you sure you want to delete this job?</p>
              <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>
              <button type="button" class="btn btn-danger my-2 text-white" id="delete-job-submit" data-dismiss="modal">Delete</button>
          </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}